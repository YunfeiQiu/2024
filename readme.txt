在水印嵌入与提取过程中，首先利用四元数对颜色通道进行关联，有效解决了传统水印方案忽略颜色通道关联性、水印同步嵌入困难的问题；然后对嵌入块进行近似Schur分解，利用矩阵分解后产生的最大能量系数，通过四元数实现水印嵌入与盲提取四元数量化指数调制（QQIM），其中考虑了几何攻击后的图像校正。由于四元数计算复杂，本文采用代数结构保留算法，将四元数计算转化为实数和复数计算，提高算法效率。
执行的主函数可以在“main_FQSD.m”中找到。攻击测试可以在“testAttack.m”中找到。
